var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},amp;(function(n){var i,t,f,e,r,u,o,s;n.plugin("AMVE",function(n){var t=this,i,u=this;n&&n.containerId&&(i=new r(t,n))});i=function(){function n(){}return n}();n.AMVEClipData=i;t=function(){function n(){this.playPauseShortcut="space";this.markInShortcut="i";this.markOutShortcut="o";this.goToInShortcut="shift+i";this.goToOutShortcut="shift+o";this.clearInShortcut="ctrl+shift+i";this.clearOutShortcut="ctrl+shift+o";this.clearBothShortcut="ctrl+shift+x";this.playInToOutShortcut="ctrl+shift+space";this.playToOutShortcut="ctrl+space";this.ffwdShortcut="ctrl+right";this.rwdShortcut="ctrl+left";this.backOneFrameShortcut="left";this.backFiveFramesShortcut="shift+left";this.backOneSecondShortcut="alt+shift+left";this.backOneGopShortcut="ctrl+shift+left";this.fwdOneFrameShortcut="right";this.fwdFiveFramesShortcut="shift+right";this.fwdOneSecondShortcut="alt+shift+right";this.fwdOneGopShortcut="ctrl+shift+right";this.markInOneFrameShortcut="alt+,";this.markInFiveFramesShortcut="alt+shift+,";this.markOutOneFrameShortcut="alt+.";this.markOutFiveFramesShortcut="alt+shift+.";this.undoShortcut="ctrl+z";this.redoShortcut="ctrl+y";this.exportShortcut="s";this.changeModeVirtualShortcut="shift+v";this.changeModeRenderedShortcut="shift+r";this.changeModeTrimShortcut="shift+t"}return n}();n.KeyboardShortcutConfig=t;f=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t);n.AdobePremierProShortcutConfig=f;e=function(n){function t(){n.apply(this,arguments);this.playPauseShortcut="space||`";this.markInShortcut="f1||alt+q";this.markOutShortcut="f2||alt+w";this.goToInShortcut="alt+e";this.goToOutShortcut="alt+r";this.clearInShortcut="d";this.clearOutShortcut="f";this.clearBothShortcut="g";this.playInToOutShortcut="6";this.playToOutShortcut="5";this.ffwdShortcut="ctrl+right";this.rwdShortcut="ctrl+left";this.backOneFrameShortcut="left";this.backFiveFramesShortcut="alt+left||1";this.backOneSecondShortcut="alt+shift+left";this.backOneGopShortcut="ctrl+shift+left";this.fwdOneFrameShortcut="right||4";this.fwdFiveFramesShortcut="alt+right||2";this.fwdOneSecondShortcut="alt+shift+right";this.fwdOneGopShortcut="ctrl+shift+right";this.markInOneFrameShortcut="alt+,";this.markInFiveFramesShortcut="alt+shift+,";this.markOutOneFrameShortcut="alt+.";this.markOutFiveFramesShortcut="alt+shift+.";this.undoShortcut="ctrl+z";this.redoShortcut="ctrl+y";this.exportShortcut="s";this.changeModeVirtualShortcut="shift+v";this.changeModeRenderedShortcut="shift+r";this.changeModeTrimShortcut="shift+t"}return __extends(t,n),t}(t);n.AvidShortcutConfig=e;r=function(){function n(n,t){var r,i;if(this._eventHandlers={},!t.containerId)throw new Error("AMVE options Error: you must specify a containerId!");if(!t.clipdataCallback)throw new Error("AMVE options Error: you must specify a clipdataCallback!");r=this;this.player=n;this.player.controls(!1);this.containerId=t.containerId;this.customMetadataContainerId=t.customMetadataContainerId;this._clipDataCallback=t.clipdataCallback;this._shortcutConfig=t.keyboardShortcutConfig;i=!1;this.player.addEventListener("loadedmetadata",function(){i=!1});this.player.addEventListener("play",function(){i==!1&&(i=!0,r.player.pause())});this._amveUX=new l(this)}return n.prototype.addEventListener=function(n,t){this._eventHandlers[n]=this._eventHandlers[n]||[];this._eventHandlers[n].push(t)},n.prototype.removeEventListener=function(n,t){this._eventHandlers[n]=this._eventHandlers[n]||[];this._eventHandlers[n].pop(t)},n.prototype.trigger=function(n){var i=this._eventHandlers[n],t;if(i)for(t=0;t<i.length;t+=1)i[t](n)},Object.defineProperty(n.prototype,"clipData",{get:function(){return this._clipData},set:function(n){this._clipData=n;this.trigger("clipdatacreated");this._clipDataCallback&&this._clipDataCallback(this._clipData)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"keyboardShortcutConfig",{get:function(){return this._shortcutConfig},enumerable:!0,configurable:!0}),n}();n.AMVECore=r;u=function(){function n(n,t,i,r,u){this._time=-1;this._dataUrl=null;this._width=null;this._height=null;this._imageType=null;this._time=n;this._dataUrl=t;this._width=i;this._height=r;this._imageType=u}return Object.defineProperty(n.prototype,"time",{get:function(){return this._time},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataUrl",{get:function(){return this._dataUrl},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageType",{get:function(){return this._imageType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){if(this._dataUrl!=null&&this._imageType!=null){var n=this._dataUrl.indexOf("base64,");return n>=0?this._dataUrl.substr(n+7,this._dataUrl.length-n+1):null}return null},enumerable:!0,configurable:!0}),n}();n.ThumbnailData=u;o=function(){function n(n,t,i,r){this.Left=n;this.Top=t;this.Right=i;this.Bottom=r}return n}(),function(n){n[n.Trim=0]="Trim";n[n.Virtual=1]="Virtual";n[n.Rendered=2]="Rendered"}(s||(s={})),function(n){n[n.TwentyThreeNineSevenSixFPS=0]="TwentyThreeNineSevenSixFPS";n[n.TwentyFiveFPS=1]="TwentyFiveFPS";n[n.TwentyNineNineSevenSixFPS=2]="TwentyNineNineSevenSixFPS";n[n.ThirtyFPS=3]="ThirtyFPS";n[n.SixtyFPS=4]="SixtyFPS"}(n.AMVEFrameRates||(n.AMVEFrameRates={}));var g=n.AMVEFrameRates,h=function(){function n(n,t,i,r){typeof r=="undefined"&&(r=!1);this.shouldPropagate=!1;n&&n.length>0&&(this.shortcutTxt=n.toLowerCase(),this.callback=t,this._keydownListener=i,this.shouldPropagate=r)}return Object.defineProperty(n.prototype,"keydownListener",{get:function(){return this._keydownListener},enumerable:!0,configurable:!0}),n}(),c=function(){function n(){this._shortcuts=[];this.specialKeys={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll:145,capslock:20,caps:20,numlock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,pagedown:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"=":187,",":188,".":190,"`":192}}return n.prototype.addShortcut=function(n,t,i){if(typeof i=="undefined"&&(i=!1),n&&n.length>0&&t)if(this._shortcuts.findFirst(function(t){return t.shortcutTxt==n}))throw new Error("There is already a shortcut registered for: "+n);else{var r=this,u=function(u){var o,l,h,e,c,f,v,s,a;if(u.target?o=u.target:u.srcElement&&(o=u.srcElement),o.nodeType==3&&(o=o.parentNode),o.tagName!="INPUT"&&o.tagName!="TEXTAREA")for(l=n.split("||"),h=0;h<l.length;h++)if(e=l[h].split("+"),c=u.keyCode||u.which,c&&(f={ctrl:!1,shift:!1,alt:!1,meta:!1,targetChar:""},e.length==3?(f.ctrl=e[0]=="ctrl"||e[1]=="ctrl",f.shift=e[0]=="shift"||e[1]=="shift",f.alt=e[0]=="alt"||e[1]=="alt",f.meta=e[0]=="meta"||e[1]=="meta",f.targetChar=e[2],v=f):e.length==2?(f.ctrl=e[0]=="ctrl",f.shift=e[0]=="shift",f.alt=e[0]=="alt",f.meta=e[0]=="meta",f.targetChar=e[1]):f.targetChar=e[0],s=(f.ctrl&&u.ctrlKey||!f.ctrl&&!u.ctrlKey)&&(f.shift&&u.shiftKey||!f.shift&&!u.shiftKey)&&(f.alt&&u.altKey||!f.alt&&!u.altKey)&&(f.meta&&u.metaKey||!f.meta&&!u.metaKey),s&&(r.specialKeys[f.targetChar]?s=r.specialKeys[f.targetChar]==c:(a=String.fromCharCode(c).toLowerCase(),s=f.targetChar==a),s))){if(t(u),!i)return u.cancelBubble=!0,u.returnValue=!1,u.preventDefault&&u.preventDefault(),u.stopPropagation&&u.stopPropagation(),!1;break}},f=new h(n,t,u,i);this._shortcuts.push(f);document.addEventListener("keydown",u,!1)}return null},n.prototype.removeShortcut=function(n){var t=this._shortcuts.findFirst(function(t){return t.shortcutTxt==n});t&&(document.removeEventListener("keydown",t.keydownListener,!1),this._shortcuts.splice(this._shortcuts.indexOf(t),1))},n}(),l=function(){function n(n){this._mode=1;this._frameRate=3;this.markIn=-1;this.markOut=-1;this.minClipDuration=1;this.dvrWindowThresholdBoundary=30;this._thumbnailWidth=160;this._thumbnailCount=5;this._eventHandlers={};var t=this;this._amveCore=n;this._amveCore&&this._amveCore.player&&this._amveCore.containerId&&(this.player=this._amveCore.player,this.player.playerElement()&&this._amveCore.containerId&&(this._container=document.getElementById(this._amveCore.containerId),this._container&&(this._container.className="amve-container",this._container.tabIndex=0,this._thumbnailGeneratorContainer=this.createElement(["amve-thumbnail-canvas-container"]),this._container.appendChild(this._thumbnailGeneratorContainer),this._thumbnailGeneratorCanvas=this.createElement(["amve-thumbnail-canvas"],"canvas"),this._thumbnailGeneratorCanvas.width=160,this._thumbnailGeneratorCanvas.width=120,this._thumbnailGeneratorCanvas.style.display="none",this._thumbnailGeneratorContainer.appendChild(this._thumbnailGeneratorCanvas),this._topControlBar=new a(this),this.player.playerElement().parentElement&&(this._playerContainer=this.createElement(["amve-player-container"]),this._container.appendChild(this._playerContainer),this.player.playerElement().parentElement.removeChild(this.player.playerElement()),this._playerContainer.appendChild(this.player.playerElement())),this._bottom=this.createElement(["amve-bottom"]),this.appendChild(this._bottom),this._playerControlBar=new v(this),this._markControlBar=new y(this),this._scrubber=new p(this),this._bottomControlBar=new w(this),this._submitDlg=new b(this),this._settingsDlg=new k(this),this._amveCore.customMetadataContainerId&&(this._submitDlg.customMetadataContainer=document.getElementById(this._amveCore.customMetadataContainerId)),window.addEventListener("resize",function(){t.resize()}),this.player.addEventListener("loadedmetadata",function(){function n(){t.reset(!0);t.player.removeEventListener("loadeddata",n)}t.player.addEventListener("loadeddata",n)}),this.player.addEventListener("click",function(){t.player.paused()?t.player.play():t.player.pause()}),this.resizePlayer(),this.setupKeybaordShortcuts())))}return Object.defineProperty(n.prototype,"numThumbnails",{get:function(){return this._thumbnailCount},set:function(n){this._thumbnailCount=n;this.trigger("settingschanged")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mode",{get:function(){return this._mode},set:function(n){var i,t;if(n!=this._mode){if(this._mode=n,i=this.player.currentTime(),this.markIn>=0){t=this.scrutinizeMark(this.markIn);this.onMarkIn(t)}if(this.markOut>0){t=this.scrutinizeMark(this.markOut);this.onMarkOut(t)}this.player.currentTime(i);this.trigger("modechanged")}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"containerElement",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clientWidth",{get:function(){return this._container.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._container.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"frameRate",{get:function(){return this._frameRate},set:function(n){this._frameRate=n;this.trigger("frameratechanged")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"playerMargin",{get:function(){var n=this.pxToNumber(window.getComputedStyle(this.player.playerElement(),null).getPropertyValue("margin-left")),t=this.pxToNumber(window.getComputedStyle(this.player.playerElement(),null).getPropertyValue("margin-top")),i=this.pxToNumber(window.getComputedStyle(this.player.playerElement(),null).getPropertyValue("margin-right")),r=this.pxToNumber(window.getComputedStyle(this.player.playerElement(),null).getPropertyValue("margin-bottom"));return n&&t&&i&&r?new o(n,t,i,r):null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clipData",{set:function(n){this.toggleSubmitDlg(!1);this.player.isLive()&&n&&(n.markIn>=0&&(n.markIn=this.player.toPresentationTime(n.markIn)),n.markOut>0&&(n.markOut=this.player.toPresentationTime(n.markOut)));this._amveCore.clipData=n},enumerable:!0,configurable:!0}),n.prototype.resize=function(){this.resizePlayer();this.resizeSubmitDlg();this.resizeSettingsDlg()},n.prototype.resizePlayer=function(){if(this.player){var n=this.playerMargin,t=this._container.clientWidth-n.Left-n.Right,i=this._container.clientHeight-this._topControlBar.clientHeight-this._bottomControlBar.clientHeight-n.Top-n.Bottom;this.player.width(t);this.player.height(i);this.player.playerElement().width=t;this.player.playerElement().height=i}},n.prototype.resizeSubmitDlg=function(){if(this._submitDlg){var i=this.findPosition(this._container),n=(this.clientHeight-this._submitDlg.clientHeight)/2,t=(this.clientWidth-this._submitDlg.clientWidth)/2;this._submitDlg.style.top=n+"px";this._submitDlg.style.left=t+"px"}},n.prototype.resizeSettingsDlg=function(){if(this._settingsDlg){var i=this.findPosition(this._container),n=(this.clientHeight-this._settingsDlg.clientHeight)/2,t=(this.clientWidth-this._settingsDlg.clientWidth)/2;this._settingsDlg.style.top=n+"px";this._settingsDlg.style.left=t+"px"}},n.prototype.setupKeybaordShortcuts=function(){if(this._amveCore.keyboardShortcutConfig){var n=this;this._keyboardShortcutMgr=new c;this._amveCore.keyboardShortcutConfig.playPauseShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.playPauseShortcut,function(){n.player.paused()?n.player.play():n.player.pause()});this._amveCore.keyboardShortcutConfig.markInShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markInShortcut,function(){n.onMarkIn(n.player.currentTime())});this._amveCore.keyboardShortcutConfig.markOutShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markOutShortcut,function(){n.onMarkOut(n.player.currentTime())});this._amveCore.keyboardShortcutConfig.goToInShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.goToInShortcut,function(){n.markIn>=0&&n.player.currentTime(n.markIn)});this._amveCore.keyboardShortcutConfig.goToOutShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.goToOutShortcut,function(){n.markOut>=0&&n.player.currentTime(n.markOut)});this._amveCore.keyboardShortcutConfig.playInToOutShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.playInToOutShortcut,function(){n.markIn>=0&&n.markOut>n.markIn&&(n.player.pause(),n.player.currentTime(n.markIn),n.player.addEventListener("timeupdate",function(){n.player.currentTime()>=n.markOut&&n.player.pause()}),n.player.play())});this._amveCore.keyboardShortcutConfig.playToOutShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.playToOutShortcut,function(){n.markOut>0&&(n.player.pause(),n.player.addEventListener("timeupdate",function(){n.player.currentAbsoluteTime()==n.markOut&&n.player.pause()}),n.player.play())});this._amveCore.keyboardShortcutConfig.rwdShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.rwdShortcut,function(){n._playerControlBar.rwd()});this._amveCore.keyboardShortcutConfig.ffwdShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.ffwdShortcut,function(){n._playerControlBar.ffwd()});this._amveCore.keyboardShortcutConfig.backOneFrameShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.backOneFrameShortcut,function(){var i,t;n.mode==2&&(i=n.player.currentTime(),i>0&&(t=n.prevFrame(i),t<=0&&(t=0),n.player.currentTime(t)))});this._amveCore.keyboardShortcutConfig.backFiveFramesShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.backFiveFramesShortcut,function(){var i,t,r;if(n.mode==2&&(i=n.player.currentTime(),i>0)){for(t=n.prevFrame(i),r=0;r<4;r++)if(t=n.prevFrame(i),t<=0){t=0;break}n.player.currentTime(t)}});this._amveCore.keyboardShortcutConfig.backOneSecondShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.backOneSecondShortcut,function(){var i=n.player.currentTime(),t;i>0&&(t=i-1,t<=0&&(t=0),n.player.currentTime(t))});this._amveCore.keyboardShortcutConfig.fwdOneFrameShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.fwdOneFrameShortcut,function(){var r,t,i;n.mode==2&&(r=n.player.currentTime(),t=n.player.duration(),r<t&&(i=n.nextFrame(r),i>t&&(i=t),n.player.currentTime(i)))});this._amveCore.keyboardShortcutConfig.fwdFiveFramesShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.fwdFiveFramesShortcut,function(){var i,r,t,u;if(n.mode==2&&(i=n.player.currentTime(),r=n.player.duration(),i<r)){for(t=n.prevFrame(i),u=0;u<4;u++)if(t=n.nextFrame(i),t>r){t=r;break}n.player.currentTime(t)}});this._amveCore.keyboardShortcutConfig.fwdOneSecondShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.fwdOneSecondShortcut,function(){var r=n.player.currentTime(),i=n.player.duration(),t;r<i&&(t=r+1,t>i&&(t=i),n.player.currentTime(t))});this._amveCore.keyboardShortcutConfig.backOneGopShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.backOneGopShortcut,function(){var i,t;(n.mode==1||n.mode==0)&&(i=n.player.currentTime(),i>0&&(t=n.prevGop(i),t<=0&&(t=0),n.player.currentTime(t)))});this._amveCore.keyboardShortcutConfig.fwdOneGopShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.fwdOneGopShortcut,function(){var r,t,i;(n.mode==1||n.mode==0)&&(r=n.player.currentTime(),t=n.player.duration(),r<t&&(i=n.nextGop(r),i>t&&(i=t),n.player.currentTime(i)))});this._amveCore.keyboardShortcutConfig.markInOneFrameShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markInOneFrameShortcut,function(){if(n.mode==2&&n.markIn>0){var t=n.prevFrame(n.markIn);t<=0&&(t=0);n.onMarkIn(t)}});this._amveCore.keyboardShortcutConfig.markInFiveFramesShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markInFiveFramesShortcut,function(){var t,i;if(n.mode==2&&n.markIn>0){for(t=n.prevFrame(n.markIn),i=0;i<4;i++)if(t=n.prevFrame(t),t<=0){t=0;break}n.onMarkIn(t)}});this._amveCore.keyboardShortcutConfig.markOutOneFrameShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markOutOneFrameShortcut,function(){if(n.mode==2&&n.markOut>0){var t=n.nextFrame(n.markOut),i=n.player.duration();t>i&&(t=i);n.onMarkOut(t)}});this._amveCore.keyboardShortcutConfig.markOutFiveFramesShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.markOutFiveFramesShortcut,function(){var t,i,r;if(n.mode==2&&n.markOut>0){for(t=n.nextFrame(n.markOut),i=n.player.duration(),r=0;r<4;r++)if(t=n.nextFrame(t),t>i){t=i;break}n.onMarkOut(t)}});this._amveCore.keyboardShortcutConfig.clearInShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.clearInShortcut,function(){n.onMarkIn(-1)});this._amveCore.keyboardShortcutConfig.clearOutShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.clearOutShortcut,function(){n.onMarkOut(-1)});this._amveCore.keyboardShortcutConfig.clearBothShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.clearBothShortcut,function(){n.onMarkIn(-1);n.onMarkOut(-1)});this._amveCore.keyboardShortcutConfig.changeModeVirtualShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.changeModeVirtualShortcut,function(){n.mode=1});this._amveCore.keyboardShortcutConfig.changeModeRenderedShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.changeModeRenderedShortcut,function(){n.mode=2});this._amveCore.keyboardShortcutConfig.changeModeTrimShortcut&&this._keyboardShortcutMgr.addShortcut(this._amveCore.keyboardShortcutConfig.changeModeTrimShortcut,function(){n.mode=0})}},n.prototype.pxToNumber=function(n){var t=0;return n&&n!="0"&&n.indexOf("px")>0&&(t=parseInt(n.substring(0,n.length-2))),t},n.prototype.findPosition=function(n){var t,r,i,u,f,e,o,s,h;return(n.getBoundingClientRect&&n.parentNode&&(t=n.getBoundingClientRect()),!t)?(t.left=0,t.top=0,t):(r=document.documentElement,i=document.body,u=r.clientLeft||i.clientLeft||0,f=window.pageXOffset||i.scrollLeft,e=t.left+f-u,o=r.clientTop||i.clientTop||0,s=window.pageYOffset||i.scrollTop,h=t.top+s-o,t.left=Math.round(e),t.top=Math.round(h),t)},n.prototype.getDurationPercentage=function(n){var t=this.player.duration();return n==0||t==0?0:(n<0&&(n=this.player.currentTime()),n>=t)?1:n/t},n.prototype.getCWPercentage=function(n,t){var i=this.getDurationPercentage(n);return t.clientWidth*i},n.prototype.calculateDistanceX=function(n,t){var i,r,u,f;return i=this.findPosition(t),u=Math.max(t.offsetWidth,t.clientWidth),r=i.left,f=n?n.changedTouches?n.changedTouches[0].pageX:n.pageX:0,Math.max(0,Math.min(1,(f-r)/u))},n.prototype.calculateDistanceY=function(n,t){var i,r,u,f;return i=this.findPosition(t),u=Math.max(t.offsetHeight,t.clientHeight),r=i.top,f=n?n.changedTouches?n.changedTouches[0].pageY:n.pageY:0,Math.max(0,Math.min(1,(f-r)/u))},n.prototype.createElement=function(n,t){typeof t=="undefined"&&(t="div");var i=document.createElement(t);return n&&n.forEach(function(n){i.classList.add(n)}),i.tabIndex=0,i},n.prototype.appendChild=function(n){n&&this._container.appendChild(n)},n.prototype.appendBottomChild=function(n){n&&this._bottom.appendChild(n)},n.prototype.toggleSubmitDlg=function(n){n==!0?(this._submitDlg.style.display="block",this.resizeSubmitDlg()):this._submitDlg.style.display="none"},n.prototype.toggleSettingsDlg=function(n){n==!0?(this._settingsDlg.style.display="block",this.resizeSettingsDlg()):this._settingsDlg.style.display="none"},n.prototype.checkClipDuration=function(){if(this.markIn>=0&&(this.mode==0||this.markOut>0)){var n=this.player.duration()-this.markIn;if(this.mode!=0&&(n=this.markOut-this.markIn),n<this.minClipDuration)if(this.markOut>=this.player.duration()-this.minClipDuration)this.onMarkIn(this.markIn-this.minClipDuration,!0);else this.onMarkOut(this.markOut+this.minClipDuration,!0);return n}return this.markIn>=0?this.player.duration()-this.markIn:this.player.duration()},n.prototype.closestFrame=function(n){var t=this.frameRateVal(),i;return n%t!=0&&(i=Math.round(n/t),n=i*t),n<0?n=0:n>this.player.duration()&&(n=this.player.duration()),n},n.prototype.prevFrame=function(n){var i=this.frameRateVal(),t=this.closestFrame(n)-i;return t<0&&(t=0),t},n.prototype.nextFrame=function(n){var i=this.frameRateVal(),t=this.closestFrame(n)+i,r=this.player.duration();return t>r&&(t=this.player.duration()),t},n.prototype.closestGop=function(n,t){var i,f,r,u;return(typeof t=="undefined"&&(t=0),i=this.player.segmentBoundaries(),i)?(this.player.isLive&&(n=this.player.toPresentationTime(n)),f=!1,i.indexOf(n)!=-1&&t==0)?(this.player.isLive&&(n=this.player.fromPresentationTime(n)),n):(i.indexOf(n)==-1&&(i.push(n),i.sort(function(n,t){return n-t}),f=!0),r=i.indexOf(n),u=i[t<0?r-1:r+1],f&&i.splice(r,1),this.player.isLive()&&(u=this.player.fromPresentationTime(u)),u):n},n.prototype.prevGop=function(n){return this.closestGop(n,-1)},n.prototype.nextGop=function(n){return this.closestGop(n,1)},Object.defineProperty(n.prototype,"dvrWindow",{get:function(){var n=this.player.currentPlayableWindow(),t=this.player.manifestPlayableWindowLength();if(t&&n&&n.length==2){var u=n[1]-n[0],i=n[1]-n[0],r=i-t;return[r,i]}return null},enumerable:!0,configurable:!0}),n.prototype.scrutinizeMark=function(n){switch(this._mode){case 2:return this.closestFrame(n);case 0:return this.closestGop(n);case 1:return this.closestGop(n)}},n.prototype.onMarkIn=function(n,t){if(typeof t=="undefined"&&(t=!1),n>=0){if(this.markIn=this.scrutinizeMark(n),this.markOut>0&&n>=this.markOut)this.onMarkOut(this.markIn+this.minClipDuration);this.markIn>=0&&this.player.currentTime(this.markIn)}else this.markIn=-1,this.player.currentTime(0);t||this.trigger("markin");this.onMark(t)},n.prototype.onMarkOut=function(n,t){typeof t=="undefined"&&(t=!1);n>0?(this.markIn>=0&&n<=this.markIn&&(n=this.markIn+this.minClipDuration),this.markOut=this.scrutinizeMark(n),this.markOut>0&&this.player.currentTime(this.markOut)):(this.markOut=-1,this.player.currentTime(0));t||this.trigger("markout");this.onMark(t)},n.prototype.onMark=function(n){typeof n=="undefined"&&(n=!1);n||this.trigger("mark")},n.prototype.getKeyframes=function(n,t,i){var u,r,f,e;if(typeof n=="undefined"&&(n=-1),typeof t=="undefined"&&(t=-1),typeof i=="undefined"&&(i=-1),n==-1&&(n=0),t==-1&&(t=this.player.duration()),t-n>this.frameRateVal()){for(u=[],r=this.closestFrame(n),u.push(r),f=1;r<t&&(i<1||f<i);)if(f++,e=this.nextFrame(r),e>r)r=e,u.push(r);else break;return u.sort(function(n,t){return n-t}),u}return null},n.prototype.getClipGops=function(n){var r,t,u,i;if(typeof n=="undefined"&&(n=-1),this.markIn>=0&&this.markOut>0){if(r=[],t=this.closestGop(this.markIn),r.push(t),(n<=0||n>1)&&t<this.player.duration())for(i=this.nextGop(t),r.push(i),u=2;i>t&&i<this.player.duration()&&(n<=0||u<n);)i=this.nextGop(t),r.push(i),t=i;return r}return null},n.prototype.generateThumbnails=function(){var i,r;if(this.trigger("thumbnailsgenerating"),this.thumbnails=[],this.markIn>=0&&(this.mode==0||this.markOut>0)){i=this.player.paused();r=this.player.currentTime();this.player.pause();var n=this,u=0,t=this.markIn,o=2,f=n.player.duration();n.mode!=0&&(f=n.markOut);e();function e(){u<n._thumbnailCount&&t<=f?(n.player.currentTime(t),n.captureThumbail(t,function(i){i&&n.thumbnails.push(i);t+=o;u++;e()})):(n.thumbnails.sort(function(n,t){return n.time-t.time}),n.player.currentTime(r),i==!1&&n.player.play(),n.trigger("thumbnailsgenerated"))}}},n.prototype.captureThumbail=function(n,t){var s=this,e;this.player.currentTime(n);var i=this._thumbnailGeneratorCanvas,o=this.player.playerElement().getElementsByTagName("video")[0],r=160,f=120;i.height=f;i.width=r;e=i.getContext("2d");setTimeout(function(){e.drawImage(o,0,0,r,f);var s=null,h=i.toDataURL("image/png",.5);h&&(s=new u(n,h,r,f,"image/png"));t(s)},600)},n.prototype.formatTime=function(n){var f=Math.floor(n*100)%100,i=Math.floor(n%60),r=Math.floor(n/60)%60,u=Math.floor(n/3600)%3600,t="";return t=t+(u<10?"0"+u:""+u),t=t+":"+(r<10?"0"+r:""+r),t+":"+(i<10?"0"+i:""+i)},n.prototype.formatTimeWords=function(n){var f=Math.floor(n*100)%100,i=Math.floor(n%60),r=Math.floor(n/60)%60,u=Math.floor(n/3600)%3600,t="";return t=t+(u>0?u+" hours":""),t=t+(r>0?(t.length>0?" ":"")+r+" minutes":""),t+(i>0?(t.length>0?" ":"")+i+" seconds":"")},n.prototype.parseTime=function(n){var i=-1;if(n&&n.indexOf(":")>0){var o=n,r=0,u=0,f=0,e=0,t=o.split(":");t.length==4&&(r=parseInt(t[0]),u=parseInt(t[1]),f=parseInt(t[2]),e=parseInt(t[3]),i=r*3600+u*60+f+e/100)}return i},n.prototype.frameRateBaseVal=function(n){var t=1;switch(n){case 0:t=23.976;break;case 1:t=25;break;case 2:t=29.976;break;case 3:t=30;break;case 4:t=60}return t},n.prototype.frameRateVal=function(n){return typeof n=="undefined"&&(n=null),n||(n=this.frameRate),1/this.frameRateBaseVal(n)},n.prototype.frameRateToString=function(n){return this.frameRateBaseVal(n)+" fps"},n.prototype.reset=function(n){if(typeof n=="undefined"&&(n=!1),this.markIn=-1,this.markOut=-1,this.clipData=null,this.trigger("markin"),this.trigger("markout"),this.trigger("mark"),this.toggleSubmitDlg(!1),this.player.isLive()||n!=!1){var t=this.player.currentPlayableWindow();t&&t.length==2&&(this.player.currentTime(this.player.fromPresentationTime(t[1])),this.trigger("liveedge"))}else this.player.currentTime(0);this.trigger("reset")},n.prototype.addContainerEventListener=function(n,t){this._container.addEventListener(n,t)},n.prototype.addEventListener=function(n,t){this._eventHandlers[n]=this._eventHandlers[n]||[];this._eventHandlers[n].push(t)},n.prototype.removeEventListener=function(n,t){this._eventHandlers[n]=this._eventHandlers[n]||[];this._eventHandlers[n].pop(t)},n.prototype.trigger=function(n){var i=this._eventHandlers[n],t;if(i)for(t=0;t<i.length;t+=1)i[t](n)},n}(),a=function(){function n(n){function i(){switch(t._amveUX.mode){case 0:t._trimBtn.classList.contains("amve-selected")||t._trimBtn.classList.add("amve-selected");t._virtualBtn.classList.contains("amve-selected")&&t._virtualBtn.classList.remove("amve-selected");t._renderedBtn.classList.contains("amve-selected")&&t._renderedBtn.classList.remove("amve-selected");break;case 1:t._trimBtn.classList.contains("amve-selected")&&t._trimBtn.classList.remove("amve-selected");t._virtualBtn.classList.contains("amve-selected")||t._virtualBtn.classList.add("amve-selected");t._renderedBtn.classList.contains("amve-selected")&&t._renderedBtn.classList.remove("amve-selected");break;case 2:t._trimBtn.classList.contains("amve-selected")&&t._trimBtn.classList.remove("amve-selected");t._virtualBtn.classList.contains("amve-selected")&&t._virtualBtn.classList.remove("amve-selected");t._renderedBtn.classList.contains("amve-selected")||t._renderedBtn.classList.add("amve-selected")}}this._submitDialogDisplayToggle=!1;var t=this;this._amveUX=n;this._controlBarElement=this._amveUX.createElement(["amve-top-controlbar"]);this._amveUX.appendChild(this._controlBarElement);this._leftCol=this._amveUX.createElement(["amve-left-column"]);this._controlBarElement.appendChild(this._leftCol);this._rightCol=this._amveUX.createElement(["amve-right-column"]);this._controlBarElement.appendChild(this._rightCol);this._submitDialogTitle=this._amveUX.createElement(["amve-submitdlg-title"]);this._leftCol.appendChild(this._submitDialogTitle);this._topMenu=this._amveUX.createElement(["amve-top-menu"]);this._rightCol.appendChild(this._topMenu);this._trimBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-trim-btn"]);this._trimBtn.innerHTML="trim";this._topMenu.appendChild(this._trimBtn);this._virtualBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-virtual-btn"]);this._virtualBtn.innerHTML="virtual";this._topMenu.appendChild(this._virtualBtn);this._renderedBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-rendered-btn"]);this._renderedBtn.innerHTML="rendered";this._topMenu.appendChild(this._renderedBtn);this._settingsBtn=this._amveUX.createElement(["amve-btn","amve-btn-control","amve-settings-btn"]);this._topMenu.appendChild(this._settingsBtn);this._amveUX.addEventListener("modechanged",i);this._settingsBtn.addEventListener("click",function(){t._amveUX.toggleSettingsDlg(!0)});i();this._trimBtn.addEventListener("click",function(){t._amveUX.mode!=0&&(t._amveUX.mode=0)});this._virtualBtn.addEventListener("click",function(){t._amveUX.mode!=1&&(t._amveUX.mode=1)});this._renderedBtn.addEventListener("click",function(){t._amveUX.mode!=2&&(t._amveUX.mode=2)})}return Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._controlBarElement.clientHeight},enumerable:!0,configurable:!0}),n}(),v=function(){function n(n){function f(){h(!0)}function e(){setTimeout(h,300)}function o(){r=!0}function s(){r=!1;h(!1)}function a(){var r=t._amveUX.findPosition(t._controlBarElement);t._volumeBar.style.display="block";t._volumeBar.style.top=r.top-t._volumeBar.clientHeight-t._controlBarElement.clientHeight-t._volumeButton.clientHeight*2-60+"px";t._volumeBar.style.left=t._controlBarElement.clientWidth-t._volumeBar.clientWidth-t._volumeButton.clientWidth/2-8+"px";t._volumeButton.classList.remove("amve-muted");var u=t._amveUX.player.volume(),n=t._volumeTrack.clientHeight*u,i=t._volumeTrack.clientHeight-n;t._volumeFill.style.height=n+"px";t._volumeFill.style.top=i+"px";t._volumeFill.style.display="block";t._volumeHandle.style.top=i+"px";t._volumeHandle.style.display="block"}function h(n){typeof n=="undefined"&&(n=!1);r==!0||n?a():t._volumeBar.style.display="none"}function c(){u=!0}function i(){u=!1}function l(n){var r,i,f,e;u&&(r=t._amveUX.calculateDistanceY(n,t._volumeBar),i=1-r,i<0&&(i=0),i>0?(t._amveUX.player.volume(i),f=t._amveUX.player.volume(),e=1):t._amveUX.player.muted(!0))}var t,r,u;this._fwdRwdTimeoutInterval=25;this._maxFwdRwdMultiplier=8;this._fwdRwdStep=.3;this._fwdRwdMultiplier=1;this._rwdFlag=!1;this._fwdFlag=!1;t=this;this._amveUX=n;this._fwdRwdStep=this._amveUX.frameRateVal();this._controlBarElement=this._amveUX.createElement(["amve-player-controlbar"]);this._amveUX.appendBottomChild(this._controlBarElement);this._volumeBar=this._amveUX.createElement(["amve-volume-bar"]);this._volumeTrack=this._amveUX.createElement(["amve-volume-track"]);this._volumeBar.appendChild(this._volumeTrack);this._volumeFill=this._amveUX.createElement(["amve-volume-fill"]);this._volumeBar.appendChild(this._volumeFill);this._volumeHandle=this._amveUX.createElement(["amve-volume-handle"]);this._volumeBar.appendChild(this._volumeHandle);this._amveUX.appendChild(this._volumeBar);this._leftCol=this._amveUX.createElement(["amve-left-column"]);this._controlBarElement.appendChild(this._leftCol);this._centerCol=this._amveUX.createElement(["amve-center-column"]);this._controlBarElement.appendChild(this._centerCol);this._rightCol=this._amveUX.createElement(["amve-right-column"]);this._controlBarElement.appendChild(this._rightCol);this._playBtn=this._amveUX.createElement(["amve-btn","amve-btn-control","amve-play-btn"]);this._leftCol.appendChild(this._playBtn);this._rwdBtn=this._amveUX.createElement(["amve-btn","amve-btn-control","amve-rwd-btn"]);this._leftCol.appendChild(this._rwdBtn);this._fwdBtn=this._amveUX.createElement(["amve-btn","amve-btn-control","amve-fwd-btn"]);this._leftCol.appendChild(this._fwdBtn);this._liveBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-live-btn"]);this._liveBtn.innerHTML="LIVE";this._liveBtn.style.display="none";this._leftCol.appendChild(this._liveBtn);this._timeDisplay=this._amveUX.createElement(["amve-time-display"]);this._centerCol.appendChild(this._timeDisplay);this._volumeButton=this._amveUX.createElement(["amve-btn","amve-btn-control","amve-volume-btn"]);this._rightCol.appendChild(this._volumeButton);this._amveUX.player.addEventListener("timeupdate",function(){if(t._amveUX.player.isLive()){var n=t._amveUX.player.currentTime(),i=t._amveUX.player.duration()-15;n>=i?t._amveUX.trigger("liveedgeon"):t._amveUX.trigger("liveedgeoff");t._timeDisplay.innerText="LIVE / "+t._amveUX.formatTime(t._amveUX.player.duration())}else t._timeDisplay.innerText=t._amveUX.formatTime(t._amveUX.player.currentTime())+" / "+t._amveUX.formatTime(t._amveUX.player.duration());t._timeDisplay.style.display="block"});this._amveUX.addEventListener("reset",function(){t.resetFwdRwd()});this._amveUX.addEventListener("liveedgeon",function(){t._liveBtn.classList.add("amve-live-edge")});this._amveUX.addEventListener("liveedgeoff",function(){t._liveBtn.classList.remove("amve-live-edge")});this._playBtn.addEventListener("click",function(){t.resetFwdRwd();t._amveUX.player.paused()?t._amveUX.player.play():t._amveUX.player.pause()});this._amveUX.player.addEventListener("loadedmetadata",function(){t._liveBtn.style.display=t._amveUX.player.isLive()?"block":"none"});this._liveBtn.addEventListener("click",function(){t._amveUX.player.paused()&&t._amveUX.player.play();t._amveUX.player.currentTime(t._amveUX.player.duration())});this._rwdBtn.addEventListener("click",function(){t.rwd()});this._fwdBtn.addEventListener("click",function(){t.ffwd()});this._volumeButton.addEventListener("pointerenter",f);this._volumeButton.addEventListener("mouseenter",f);this._volumeButton.addEventListener("touchenter",f);this._volumeButton.addEventListener("pointerleave",e);this._volumeButton.addEventListener("mouseleave",e);this._volumeButton.addEventListener("touchleave",e);this._volumeBar.addEventListener("pointerenter",o);this._volumeBar.addEventListener("mouseenter",o);this._volumeBar.addEventListener("touchenter",o);this._volumeBar.addEventListener("pointerleave",s);this._volumeBar.addEventListener("mouseleave",s);this._volumeBar.addEventListener("touchleave",s);this._volumeHandle.addEventListener("mousedown",c);this._volumeHandle.addEventListener("touchstart",c);this._volumeHandle.addEventListener("pointerdown",c);this._volumeBar.addEventListener("mouseup",i);this._volumeBar.addEventListener("touchend",i);this._volumeBar.addEventListener("pointerup",i);this._volumeBar.addEventListener("mousemove",l);this._volumeBar.addEventListener("touchmove",l);this._volumeBar.addEventListener("pointermove",l);this._volumeBar.addEventListener("pointerleave",i);this._volumeBar.addEventListener("mouseleave",i);this._volumeBar.addEventListener("touchleave",i);r=!1;u=!1;t._amveUX.player.addEventListener("volumechange",function(){var i=t._amveUX.player.muted(),n=t._amveUX.player.volume(),r;i==!0||n==0?(r=t._volumeTrack.clientHeight*n,t._volumeButton.classList.add("amve-muted"),t._volumeFill.style.display="none",t._volumeHandle.style.top=t._volumeTrack.clientHeight+"px"):a()});t._volumeButton.addEventListener("click",function(){var n=t._amveUX.player.muted();t._amveUX.player.muted(!n)});t._amveUX.player.addEventListener("play",function(){t.resetFwdRwd();t._playBtn.classList.add("amve-playing")});t._amveUX.player.addEventListener("pause",function(){t.resetFwdRwd();t._playBtn.classList.remove("amve-playing")})}return Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._controlBarElement.clientHeight},enumerable:!0,configurable:!0}),n.prototype.rwd=function(){var n=this;this._fwdFlag==!0?this.resetFwd():this._rwdFlag==!1?(this.resetFwdRwd(),this._rwdFlag=!0,this.setFwdRwdIcon(this._rwdBtn,2),this._rwdInterval=setInterval(function(){if(n._rwdFlag){var t=n._amveUX.player.currentTime()-n._fwdRwdStep*n._fwdRwdMultiplier;t>=0&&n._amveUX.player.currentTime(t)}},this._fwdRwdTimeoutInterval),this._fwdRwdMultiplier=2):this._fwdRwdMultiplier<this._maxFwdRwdMultiplier&&(this._fwdRwdMultiplier*=2,this.setFwdRwdIcon(this._rwdBtn))},n.prototype.ffwd=function(){var n=this;this._rwdFlag==!0?this.resetRwd():this._fwdFlag==!1?(this.resetFwdRwd(),this._fwdFlag=!0,this.setFwdRwdIcon(this._fwdBtn,2),this._fwdInterval=setInterval(function(){if(n._fwdFlag){var t=n._amveUX.player.currentTime()+n._fwdRwdStep*n._fwdRwdMultiplier;t<=n._amveUX.player.duration()&&n._amveUX.player.currentTime(t)}},this._fwdRwdTimeoutInterval),this._fwdRwdMultiplier=2):this._fwdRwdMultiplier<this._maxFwdRwdMultiplier&&(this._fwdRwdMultiplier*=2,this.setFwdRwdIcon(this._fwdBtn))},n.prototype.resetFwdRwd=function(){this.resetRwd();this.resetFwd()},n.prototype.resetRwd=function(){this._rwdFlag=!1;this._rwdInterval&&clearInterval(this._rwdInterval);this._fwdRwdMultiplier=1;this.setFwdRwdIcon(this._rwdBtn,1)},n.prototype.resetFwd=function(){this._fwdFlag=!1;this._fwdInterval&&clearInterval(this._fwdInterval);this._fwdRwdMultiplier=1;this.setFwdRwdIcon(this._fwdBtn,1)},n.prototype.setFwdRwdIcon=function(n,t){typeof t=="undefined"&&(t=-1);for(var i=1;i<=this._maxFwdRwdMultiplier;i*=2)n.classList.remove("speed-"+i+"x");t>0?n.classList.add("speed-"+t+"x"):n.classList.add("speed-"+this._fwdRwdMultiplier+"x")},n}(),y=function(){function n(n){function i(){t._amveUX.player.pause();t._markControlElement.style.cursor="pointer";t._isMarkInClipping=!0;t._isMarkOutClipping=!1}function r(n){if(t._isMarkInClipping){t._markControlElement.style.cursor="default";t._isMarkInClipping=!1;var r=t._amveUX.player.duration(),f=t._amveUX.player.currentTime(),u=t._amveUX.calculateDistanceX(n,t._markControlElement),i=u*r;i==r&&(i=i-.1);t._amveUX.player.currentTime(i)}}function u(){t._amveUX.player.pause();t._markControlElement.style.cursor="pointer";t._isMarkInClipping=!1;t._isMarkOutClipping=!0}function f(n){if(t._isMarkOutClipping){t._markControlElement.style.cursor="default";t._isMarkOutClipping=!1;var r=t._amveUX.player.duration(),i=t._amveUX.calculateDistanceX(n,t._markControlElement)*r;i==r&&(i=i-.1);t._amveUX.player.currentTime(i)}}function e(n){document.body.focus();t._isMarkInClipping?t.positionMarkIn(!1,n):t._isMarkOutClipping&&t.positionMarkOut(!1,n)}this._isMarkInClipping=!1;this._isMarkOutClipping=!1;this._preModeChangeMarkOut=-1;var t=this;this._amveUX=n;this._markControlElement=this._amveUX.createElement(["amve-mark-controlbar"]);this._amveUX.appendBottomChild(this._markControlElement);this._markFillElement=this._amveUX.createElement(["amve-mark-fill"]);this._markControlElement.appendChild(this._markFillElement);this._markInElement=this._amveUX.createElement(["amve-mark-in"]);this._markControlElement.appendChild(this._markInElement);this._markOutElement=this._amveUX.createElement(["amve-mark-out"]);this._markControlElement.appendChild(this._markOutElement);this._amveUX.addEventListener("modechanged",function(){var n;switch(t._amveUX.mode){case 0:t._preModeChangeMarkOut=t._amveUX.markOut;t._amveUX.onMarkOut(-1);t._markOutElement.style.display="none";t.onMark();break;case 1:if(t._amveUX.markOut<=0){n=t._amveUX.player.currentTime();t._amveUX.onMarkOut(t._preModeChangeMarkOut);t._amveUX.player.currentTime(n)}break;case 2:if(t._amveUX.markOut<=0){n=t._amveUX.player.currentTime();t._amveUX.onMarkOut(t._preModeChangeMarkOut);t._amveUX.player.currentTime(n)}}});this._amveUX.player.addEventListener("loadedmetadata",function(){function n(){t._markInElement.addEventListener("mousedown",i);t._markInElement.addEventListener("touchstart",i);t._markInElement.addEventListener("pointerdown",i);t._amveUX.addContainerEventListener("mouseup",r);t._amveUX.addContainerEventListener("touchend",r);t._amveUX.addContainerEventListener("pointerup",r);t._markOutElement.addEventListener("mousedown",u);t._markOutElement.addEventListener("touchstart",u);t._markOutElement.addEventListener("pointerdown",u);t._amveUX.addContainerEventListener("mouseup",f);t._amveUX.addContainerEventListener("touchend",f);t._amveUX.addContainerEventListener("pointerup",f);t._markControlElement.addEventListener("mousemove",e);t._markControlElement.addEventListener("touchmove",e);t._markControlElement.addEventListener("pointermove",e);t._amveUX.addEventListener("mark",function(){t.onMark()});t._amveUX.player.addEventListener("resize",function(){t.onMark()})}t._amveUX.player.addEventListener("loadeddata",n)})}return n.prototype.onMark=function(){this.positionMarkIn(!0,null);this.positionMarkOut(!0,null);this.positionMarkFill()},n.prototype.positionMarkIn=function(n,t){var r,i,u;if(n)this._amveUX.markIn>=0?(u=this._amveUX.getCWPercentage(this._amveUX.markIn,this._markControlElement),u<0&&(u=0),this._markInElement.style.left=u+"px",this._markInElement.style.display="block"):(this._markInElement.style.left="0px",this._markInElement.style.display="none");else if(r=this._amveUX.player.duration(),i=this._amveUX.calculateDistanceX(t,this._markControlElement)*r,i<=0&&(i=0),i>=r&&(i=r),this._amveUX.markOut<=0||i<=this._amveUX.markOut-this._amveUX.minClipDuration){this._markInElement.style.left=this._amveUX.getCWPercentage(i,this._markControlElement)+"px";this._markInElement.style.display="block";this._amveUX.onMarkIn(i)}},n.prototype.positionMarkOut=function(n,t){var u,r,i;if(n)this._amveUX.markOut>0?(i=this._amveUX.getCWPercentage(this._amveUX.markOut,this._markControlElement),i>this._markControlElement.clientWidth-20&&(i=this._markControlElement.clientWidth-20),this._markOutElement.style.left=i+"px",this._markOutElement.style.display="block"):(i=this._markControlElement.clientWidth-20,this._markOutElement.style.left=i+"px",this._markOutElement.style.display="none");else if(u=this._amveUX.player.duration(),r=this._amveUX.calculateDistanceX(t,this._markControlElement)*u,r<=0&&(r=0),r>=u&&(r=u),this._amveUX.markIn<0||r>=this._amveUX.markIn+this._amveUX.minClipDuration){i=this._amveUX.getCWPercentage(r,this._markControlElement);i>this._markControlElement.clientWidth-20&&(i=this._markControlElement.clientWidth-20);this._markOutElement.style.left=i+"px";this._markOutElement.style.display="block";this._amveUX.onMarkOut(r)}},n.prototype.positionMarkFill=function(){var i,n;if(this._amveUX.markIn>=0&&(this._amveUX.mode==0||this._amveUX.markOut>0)){i=this._amveUX.getDurationPercentage(this._amveUX.markIn);n=this._amveUX.getDurationPercentage(this._amveUX.markOut);this._amveUX.mode==0&&(n=this._amveUX.getDurationPercentage(this._amveUX.player.duration()));var r=n-i,u=this._amveUX.getCWPercentage(this._amveUX.markIn,this._markControlElement),t=Math.round(this._markControlElement.clientWidth*r);this._markFillElement.style.left=u+"px";this._amveUX.mode!=0&&(t=t+20);this._markFillElement.style.width=t+"px";this._markFillElement.style.display="block"}else this._markFillElement.style.display="none"},Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._markControlElement.clientHeight},enumerable:!0,configurable:!0}),n}(),p=function(){function n(n){function o(){t._isScrubbing||e(null)}function s(){e(null);u()}function u(){if(t._amveUX.markIn>=0&&t._amveUX.markOut>0){var n=t._amveUX.getDurationPercentage(t._amveUX.markIn),i=t._amveUX.getDurationPercentage(t._amveUX.markOut),r=i-n,u=t._amveUX.getCWPercentage(t._amveUX.markIn,t._scrubberElement),f=Math.round(t._scrubberElement.clientWidth*r);t._scrubberMarkFillElement.style.left=u+"px";t._scrubberMarkFillElement.style.width=f+"px";t._scrubberMarkFillElement.style.display="block"}else t._scrubberMarkFillElement.style.display="none"}function i(){t._scrubberElement.style.cursor="pointer";t._isScrubbing=!0}function r(n){if(t._isScrubbing){t._scrubberElement.style.cursor="default";t._isScrubbing=!1;var r=t._amveUX.player.duration(),i=t._amveUX.calculateDistanceX(n,t._scrubberElement)*r;i!=t._amveUX.player.currentTime()&&(i==r&&(i=i-.1),t._amveUX.player.currentTime(i))}}function f(n){t._isScrubbing&&e(n)}function e(n){var i=t._amveUX.player.currentTime(),r=t._amveUX.player.duration();t._isScrubbing&&n&&(i=t._amveUX.calculateDistanceX(n,t._scrubberElement)*r,i==r&&(i=i-.1));var f=t._amveUX.findPosition(t._amveUX.containerElement),e=t._amveUX.findPosition(t._scrubberElement),u=t._amveUX.getCWPercentage(i,t._scrubberElement),o=e.left-f.left-t._scrubberHandleElement.clientWidth+10+u;t._scrubberHandleElement.style.left=o+"px";t._scrubberProgressElement.style.width=u+"px"}this._scrubbingTimeoutFlag=!1;this._scrubbingTimeoutInterval=1e3;this._isScrubbing=!1;this._lastTime=0;var t=this;this._amveUX=n;this._amveUX.player.addEventListener("timeupdate",o);this._amveUX.player.addEventListener("resize",s);this._amveUX.addEventListener("markin",u);this._amveUX.addEventListener("markout",u);this._scrubberElement=this._amveUX.createElement(["amve-scrubber"]);this._amveUX.appendBottomChild(this._scrubberElement);this._scrubberProgressElement=this._amveUX.createElement(["amve-scrubber-progress"]);this._scrubberElement.appendChild(this._scrubberProgressElement);this._scrubberMarkFillElement=this._amveUX.createElement(["amve-scrubber-markfill"]);this._scrubberElement.appendChild(this._scrubberMarkFillElement);this._scrubberHandleElement=this._amveUX.createElement(["amve-scrubber-handle"]);this._amveUX.appendBottomChild(this._scrubberHandleElement);this._scrubberHandleElement.addEventListener("mousedown",i);this._scrubberHandleElement.addEventListener("touchstart",i);this._scrubberHandleElement.addEventListener("pointerdown",i);this._scrubberElement.addEventListener("mousedown",i);this._scrubberElement.addEventListener("touchstart",i);this._scrubberElement.addEventListener("pointerdown",i);this._amveUX.addContainerEventListener("mouseup",r);this._amveUX.addContainerEventListener("touchend",r);this._amveUX.addContainerEventListener("pointerup",r);this._amveUX.addContainerEventListener("mouseleave",r);this._amveUX.addContainerEventListener("mousemove",f);this._amveUX.addContainerEventListener("touchmove",f);this._amveUX.addContainerEventListener("pointermove",f)}return Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._scrubberElement.clientHeight},enumerable:!0,configurable:!0}),n}(),w=function(){function n(n){function i(){t._amveUX.markIn>=0&&(t._amveUX.mode==0||t._amveUX.markOut>0)?(t._clipLengthDisplay.innerHTML=t._amveUX.formatTimeWords(t._amveUX.checkClipDuration()),t._clipLengthDisplay.style.display="block",t._exportBtn.classList.remove("amve-btn-disabled")):(t._clipLengthDisplay.style.display="none",t._exportBtn.classList.add("amve-btn-disabled"));t._amveUX.markIn>=0?(t._markInDisplay.innerHTML=t._amveUX.formatTime(t._amveUX.markIn),t._markInDisplay.style.display="block"):t._markInDisplay.style.display="none";t._amveUX.markOut>0?(t._markOutDisplay.innerHTML=t._amveUX.formatTime(t._amveUX.markOut),t._markOutDisplay.style.display="block"):t._markOutDisplay.style.display="none"}function r(n,i){typeof i=="undefined"&&(i=1);var r=0;switch(t._amveUX.mode){case 2:r=i<0?t._amveUX.prevFrame(n):t._amveUX.nextFrame(n);break;case 0:r=i<0?t._amveUX.prevGop(n):t._amveUX.nextGop(n);break;case 1:r=i<0?t._amveUX.prevGop(n):t._amveUX.nextGop(n)}return r<=0?r=0:r>=t._amveUX.player.duration()&&(r=t._amveUX.player.duration()),r}this._arrowTimerTimeoutInterval=500;this._isArrowActionInProgress=!1;this._markInLeftArrowTimerFlag=!1;this._markInRightArrowTimerFlag=!1;this._markOutLeftArrowTimerFlag=!1;this._markOutRightArrowTimerFlag=!1;var t=this;this._amveUX=n;this._controlBarElement=this._amveUX.createElement(["amve-bottom-controlbar"]);this._amveUX.appendBottomChild(this._controlBarElement);this._controlBarTopElement=this._amveUX.createElement(["amve-bottom-controlbar-top"]);this._controlBarElement.appendChild(this._controlBarTopElement);this._leftCol=this._amveUX.createElement(["amve-left-column"]);this._controlBarTopElement.appendChild(this._leftCol);this._centerCol=this._amveUX.createElement(["amve-center-column"]);this._controlBarTopElement.appendChild(this._centerCol);this._centerColLeft=this._amveUX.createElement(["amve-center-column-left"]);this._centerCol.appendChild(this._centerColLeft);this._centerColCenter=this._amveUX.createElement(["amve-center-column-center"]);this._centerCol.appendChild(this._centerColCenter);this._centerColRight=this._amveUX.createElement(["amve-center-column-right"]);this._centerCol.appendChild(this._centerColRight);this._rightCol=this._amveUX.createElement(["amve-right-column"]);this._controlBarTopElement.appendChild(this._rightCol);this._resetBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-reset-btn"]);this._resetBtn.innerHTML="reset";this._leftCol.appendChild(this._resetBtn);this._exportBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-btn-disabled","amve-export-btn"]);this._exportBtn.innerHTML="export";this._rightCol.appendChild(this._exportBtn);this._frameRateDisplay=this._amveUX.createElement(["amve-framerate-display"]);this._frameRateDisplay.innerHTML=this._amveUX.frameRateToString(t._amveUX.frameRate);this._frameRateDisplay.title="The framerate should be changed in settings...";this._centerColCenter.appendChild(this._frameRateDisplay);this._clipLengthDisplay=this._amveUX.createElement(["amve-cliplength-display"]);this._centerColCenter.appendChild(this._clipLengthDisplay);this._markInControlsContainer=this._amveUX.createElement(["amve-markin-controls-container"]);this._centerColLeft.appendChild(this._markInControlsContainer);this._markInControls=this._amveUX.createElement(["amve-markin-controls"]);this._markInControlsContainer.appendChild(this._markInControls);this._markOutControlsContainer=this._amveUX.createElement(["amve-markout-controls-container"]);this._centerColRight.appendChild(this._markOutControlsContainer);this._markOutControls=this._amveUX.createElement(["amve-markout-controls"]);this._markOutControlsContainer.appendChild(this._markOutControls);this._markInLeftArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-left","amve-markin-leftarrow"]);this._markInControls.appendChild(this._markInLeftArrow);this._markInDisplayContainer=this._amveUX.createElement(["amve-markin-display-container"]);this._markInControls.appendChild(this._markInDisplayContainer);this._setMarkInBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-setmarkin-btn"]);this._setMarkInBtn.innerHTML="set in";this._markInDisplayContainer.appendChild(this._setMarkInBtn);this._markInDisplay=this._amveUX.createElement(["amve-markin-display"]);this._markInDisplayContainer.appendChild(this._markInDisplay);this._markInRightArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-right","amve-markin-rightarrow"]);this._markInControls.appendChild(this._markInRightArrow);this._markOutLeftArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-left","amve-markout-leftarrow"]);this._markOutControls.appendChild(this._markOutLeftArrow);this._markOutDisplayContainer=this._amveUX.createElement(["amve-markout-display-container"]);this._markOutControls.appendChild(this._markOutDisplayContainer);this._setMarkOutBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-setmarkout-btn"]);this._setMarkOutBtn.innerHTML="set out";this._markOutDisplayContainer.appendChild(this._setMarkOutBtn);this._markOutDisplay=this._amveUX.createElement(["amve-markout-display"]);this._markOutDisplayContainer.appendChild(this._markOutDisplay);this._markOutRightArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-right","amve-markout-rightarrow"]);this._markOutControls.appendChild(this._markOutRightArrow);this._amveUX.addEventListener("frameratechanged",function(){t._frameRateDisplay.innerHTML=t._amveUX.frameRateToString(t._amveUX.frameRate)});this._amveUX.addEventListener("modechanged",function(){switch(t._amveUX.mode){case 0:t._markInLeftArrow.title="-1 gop";t._markInRightArrow.title="+1 gop";t._markOutLeftArrow.style.display="none";t._markOutRightArrow.style.display="none";t._markOutLeftArrow.style.display="none";t._markOutDisplay.style.display="none";t._setMarkOutBtn.style.display="none";i();break;case 1:t._markInLeftArrow.title="-1 gop";t._markInRightArrow.title="+1 gop";t._markOutLeftArrow.title="-1 gop";t._markOutRightArrow.title="+1 gop";t._markOutRightArrow.style.display="block";t._markOutLeftArrow.style.display="block";t._markOutDisplay.style.display="block";t._setMarkOutBtn.style.display="block";i();break;case 2:t._markInLeftArrow.title="-1 frame";t._markInRightArrow.title="+1 frame";t._markOutLeftArrow.title="-1 frame";t._markOutRightArrow.title="+1 frame";t._markOutRightArrow.style.display="block";t._markOutLeftArrow.style.display="block";t._markOutDisplay.style.display="block";t._setMarkOutBtn.style.display="block";i()}});this._amveUX.addEventListener("mark",function(){i()});this._exportBtn.addEventListener("click",function(){t._exportBtn.classList.contains("amve-btn-disabled")||(t._amveUX.toggleSubmitDlg(!0),t._amveUX.generateThumbnails())});this._resetBtn.addEventListener("click",function(){t._amveUX.reset()});this._markInDisplay.addEventListener("click",function(){t._amveUX.markIn>=0&&t._amveUX.player.currentTime(t._amveUX.markIn)});this._markOutDisplay.addEventListener("click",function(){t._amveUX.markOut>=0&&t._amveUX.player.currentTime(t._amveUX.markOut)});this._setMarkInBtn.addEventListener("click",function(){t._amveUX.onMarkIn(t._amveUX.player.currentTime())});this._setMarkOutBtn.addEventListener("click",function(){t._amveUX.onMarkOut(t._amveUX.player.currentTime())});this._markInLeftArrow.addEventListener("click",function(){var n=r(t._amveUX.markIn,-1);if(n>=0){t._amveUX.player.currentTime(n);t._amveUX.onMarkIn(n)}});this._markInRightArrow.addEventListener("click",function(){var n=r(t._amveUX.markIn);if(n>=0){t._amveUX.player.currentTime(n);t._amveUX.onMarkIn(n)}});this._markOutLeftArrow.addEventListener("click",function(){var n=r(t._amveUX.markOut,-1);if(n>=0){t._amveUX.player.currentTime(n);t._amveUX.onMarkOut(n)}});this._markOutRightArrow.addEventListener("click",function(){var n=r(t._amveUX.markOut);if(n>=0){t._amveUX.player.currentTime(n);t._amveUX.onMarkOut(n)}})}return Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._controlBarElement.clientHeight},enumerable:!0,configurable:!0}),n}(),b=function(){function n(n){function e(){t._currentThumbnailIndex=0;t._selectedThumbnailIndex=-1;t._submitDialogThumbnails&&t._submitDialogThumbnails.forEach(function(n){n.style.display="none";n.classList.remove("amve-selected")})}function o(n,i){var r,u;t._amveUX.thumbnails&&i<t._amveUX.thumbnails.length?(r=t._amveUX.thumbnails[i],r?(u=t._amveUX.formatTime(r.time),n.alt=u,n.title=u,n.setAttribute("src",r.dataUrl),n.style.display="block",t._selectedThumbnailIndex==i?n.classList.add("amve-selected"):n.classList.remove("amve-selected")):(n.classList.remove("amve-selected"),n.style.display="none")):(n.classList.remove("amve-selected"),n.style.display="none")}function f(){t._amveUX.thumbnails&&t._amveUX.thumbnails.length>0?(t._currentThumbnailIndex<0?t._currentThumbnailIndex=0:t._currentThumbnailIndex>t._amveUX.thumbnails.length-3&&(t._currentThumbnailIndex=t._amveUX.thumbnails.length-3),t._submitDialogThumbnails&&t._submitDialogThumbnails.forEach(function(n,i){var r=t._currentThumbnailIndex+i;r<t._amveUX.thumbnails.length?o(n,r):n.style.display="none"}),t._submitDialogThumbnailsLeftArrow.classList.add("amve-btn-disabled"),t._submitDialogThumbnailsRightArrow.classList.add("amve-btn-disabled"),t._amveUX.thumbnails.length>3&&(t._currentThumbnailIndex>0&&t._submitDialogThumbnailsLeftArrow.classList.remove("amve-btn-disabled"),t._currentThumbnailIndex<t._amveUX.thumbnails.length-3&&t._submitDialogThumbnailsRightArrow.classList.remove("amve-btn-disabled")),t._submitDialogThumbnailsContainer.style.display="block"):t._submitDialogThumbnailsContainer.style.display="none"}var t,u,r;for(this._numThumbnailsToDisplay=3,this._currentThumbnailIndex=0,this._selectedThumbnailIndex=0,t=this,this._amveUX=n,this._submitDialogContainer=this._amveUX.createElement(["amve-submitdlg-entry"]),this._amveUX.appendChild(this._submitDialogContainer),this._submitDialogSpinnerContainer=this._amveUX.createElement(["amve-submitdlg-entry-spinner-container"]),this._submitDialogContainer.appendChild(this._submitDialogSpinnerContainer),this._submitDialogSpinner=this._amveUX.createElement(["amve-submitdlg-entry-spinner"]),this._submitDialogSpinnerContainer.appendChild(this._submitDialogSpinner),this._submitDialogContent=this._amveUX.createElement(["amve-submitdlg-entry-content"]),this._submitDialogContainer.appendChild(this._submitDialogContent),this._submitDialogTop=this._amveUX.createElement(["amve-submitdlg-entry-top"]),this._submitDialogContent.appendChild(this._submitDialogTop),this._submitDialogThumbnailsContainer=this._amveUX.createElement(["amve-submitdlg-entry-thumbnails"]),this._submitDialogContent.appendChild(this._submitDialogThumbnailsContainer),this._submitDialogMiddle=this._amveUX.createElement(["amve-submitdlg-entry-middle"]),this._submitDialogContent.appendChild(this._submitDialogMiddle),this._submitDialogBottom=this._amveUX.createElement(["amve-submitdlg-entry-bottom"]),this._submitDialogContent.appendChild(this._submitDialogBottom),this._leftColTop=this._amveUX.createElement(["amve-left-column"]),this._submitDialogTop.appendChild(this._leftColTop),this._rightColTop=this._amveUX.createElement(["amve-right-column"]),this._submitDialogTop.appendChild(this._rightColTop),this._submitDialogTitle=this._amveUX.createElement(["amve-submitdlg-title"]),this._submitDialogTitle.innerHTML="export media",this._leftColTop.appendChild(this._submitDialogTitle),this._submitDialogCloseBtn=this._amveUX.createElement(["amve-btn-control","amve-close-btn"]),this._rightColTop.appendChild(this._submitDialogCloseBtn),this._submitDialogThumbnailsLeftArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-left","amve-thumbnails-leftarrow","amve-btn-disabled"]),this._submitDialogThumbnailsContainer.appendChild(this._submitDialogThumbnailsLeftArrow),this._submitDialogThumbnails=[],u=0;u<this._numThumbnailsToDisplay;u++)r=this._amveUX.createElement(["amve-thumbnail"],"img"),this._submitDialogThumbnailsContainer.appendChild(r),this._submitDialogThumbnails.push(r),r.addEventListener("click",function(n){var i=n.currentTarget;t._submitDialogThumbnails.forEach(function(n){n!=i&&n.classList.remove("amve-selected")});i.classList.contains("amve-selected")?(t._selectedThumbnailIndex=-1,r.classList.remove("amve-selected")):(i.classList.add("amve-selected"),t._selectedThumbnailIndex=t._currentThumbnailIndex)});this._submitDialogThumbnailsRightArrow=this._amveUX.createElement(["amve-btn-control","amve-chevron-right","amve-thumbnails-rightarrow","amve-btn-disabled"]);this._submitDialogThumbnailsContainer.appendChild(this._submitDialogThumbnailsRightArrow);this._submitDialogEntryTitle=this._amveUX.createElement(["amve-submitdlg-entry-title"],"input");this._submitDialogEntryTitle.setAttribute("type","text");this._submitDialogEntryTitle.value="Title...";this._submitDialogMiddle.appendChild(this._submitDialogEntryTitle);this._submitDialogDescription=this._amveUX.createElement(["amve-submitdlg-entry-description"],"textarea");this._submitDialogDescription.value="Description...";this._submitDialogMiddle.appendChild(this._submitDialogDescription);this._submitDialogCustom=this._amveUX.createElement(["amve-submitdlg-entry-custom"]);this._submitDialogMiddle.appendChild(this._submitDialogCustom);this._submitDialogBottomMargin=this._amveUX.createElement(["amve-margin"]);this._submitDialogBottom.appendChild(this._submitDialogBottomMargin);this._submitDialogCancelBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-cancel-btn"]);this._submitDialogCancelBtn.innerHTML="cancel";this._submitDialogBottom.appendChild(this._submitDialogCancelBtn);this._submitDialogSubmitBtn=this._amveUX.createElement(["amve-btn","amve-btn-text","amve-submit-btn"]);this._submitDialogSubmitBtn.innerHTML="submit";this._submitDialogBottom.appendChild(this._submitDialogSubmitBtn);this._submitDialogCloseBtn.addEventListener("click",function(){t._amveUX.toggleSubmitDlg(!1)});this._submitDialogThumbnailsLeftArrow.addEventListener("click",function(){!t._submitDialogThumbnailsLeftArrow.classList.contains("amve-btn-disabled")&&t._currentThumbnailIndex>0&&(t._currentThumbnailIndex--,f())});this._submitDialogThumbnailsRightArrow.addEventListener("click",function(){!t._submitDialogThumbnailsRightArrow.classList.contains("amve-btn-disabled")&&t._currentThumbnailIndex<t._amveUX.thumbnails.length-3&&(t._currentThumbnailIndex++,f())});this._submitDialogSubmitBtn.addEventListener("click",function(){var n=new i;n.src=t._amveUX.player.currentSrc();n.markIn=t._amveUX.markIn;n.markOut=t._amveUX.markOut;n.title=t._submitDialogEntryTitle.value;n.description=t._submitDialogDescription.value;t._amveUX.thumbnails&&t._amveUX.thumbnails.length>0&&t._selectedThumbnailIndex<t._amveUX.thumbnails.length&&(n.thumbnail=t._amveUX.thumbnails[t._selectedThumbnailIndex]);t._amveUX.clipData=n});this._amveUX.addEventListener("thumbnailsgenerating",function(){t._submitDialogSpinnerContainer.style.display="block";t._submitDialogContent.style.display="none"});this._amveUX.addEventListener("thumbnailsgenerated",function(){t._currentThumbnailIndex=0;e();f();t._submitDialogSpinnerContainer.style.display="none";t._submitDialogContent.style.display="block"})}return Object.defineProperty(n.prototype,"customMetadataContainer",{set:function(n){n&&(n.parentElement&&n.parentElement.removeChild(n),this._submitDialogCustom.appendChild(n),this._submitDialogCustom.style.display="block")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clientWidth",{get:function(){return this._submitDialogContainer.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._submitDialogContainer.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._submitDialogContainer.style},enumerable:!0,configurable:!0}),n}(),k=function(){function n(n){function i(n,i){typeof i=="undefined"&&(i=!1);var r=t._amveUX.createElement(null,"option");return r.innerText=t._amveUX.frameRateToString(n),r.value=""+n,r.selected=i,r}var t=this;this._amveUX=n;this._settingsContainer=this._amveUX.createElement(["amve-settings"]);this._amveUX.appendChild(this._settingsContainer);this._settingsTitleBar=this._amveUX.createElement(["amve-settings-title-bar"]);this._settingsContainer.appendChild(this._settingsTitleBar);this._leftColTop=this._amveUX.createElement(["amve-left-column"]);this._settingsTitleBar.appendChild(this._leftColTop);this._rightColTop=this._amveUX.createElement(["amve-right-column"]);this._settingsTitleBar.appendChild(this._rightColTop);this._settingsTitle=this._amveUX.createElement(["amve-settings-title"]);this._settingsTitle.innerHTML="settings";this._leftColTop.appendChild(this._settingsTitle);this._settingsCloseBtn=this._amveUX.createElement(["amve-btn-control","amve-close-btn"]);this._rightColTop.appendChild(this._settingsCloseBtn);this._settingsFrameRateLabel=this._amveUX.createElement(["amve-settings-framerate-label"]);this._settingsFrameRateLabel.innerHTML="frame rate:";this._settingsContainer.appendChild(this._settingsFrameRateLabel);this._settingsFrameRateInput=this._amveUX.createElement(["amve-settings-framerate-input"],"select");this._settingsFrameRateInput.options.add(i(0));this._settingsFrameRateInput.options.add(i(1));this._settingsFrameRateInput.options.add(i(2));this._settingsFrameRateInput.options.add(i(3,!0));this._settingsFrameRateInput.options.add(i(4));this._settingsContainer.appendChild(this._settingsFrameRateInput);this._settingsNumThumbailsLabel=this._amveUX.createElement(["amve-settings-numthumbnails-label"]);this._settingsNumThumbailsLabel.innerHTML="# of thumbnail choices:";this._settingsContainer.appendChild(this._settingsNumThumbailsLabel);this._settingsNumThumbails=this._amveUX.createElement(["amve-settings-numthumbnails"]);this._settingsContainer.appendChild(this._settingsNumThumbails);this._settingsNumThumbailsInput=this._amveUX.createElement(["amve-settings-numthumbnails-input"],"input");this._settingsNumThumbailsInput.setAttribute("type","range");this._settingsNumThumbailsInput.min="1";this._settingsNumThumbailsInput.max="10";this._settingsNumThumbailsInput.step="1";this._settingsNumThumbailsInput.value=""+this._amveUX.numThumbnails;this._settingsNumThumbails.appendChild(this._settingsNumThumbailsInput);this._settingsNumThumbailsDisplay=this._amveUX.createElement(["amve-settings-numthumbnails-display"]);this._settingsNumThumbailsDisplay.innerHTML=""+this._amveUX.numThumbnails;this._settingsNumThumbails.appendChild(this._settingsNumThumbailsDisplay);this._settingsCloseBtn.addEventListener("click",function(){t._amveUX.toggleSettingsDlg(!1)});this._settingsNumThumbails.addEventListener("change",function(){t._settingsNumThumbailsDisplay.innerHTML=t._settingsNumThumbailsInput.value;t._settingsNumThumbailsInput.valueAsNumber&&t._settingsNumThumbailsInput.valueAsNumber!=t._amveUX.numThumbnails&&(t._amveUX.numThumbnails=t._settingsNumThumbailsInput.valueAsNumber)});this._settingsFrameRateInput.addEventListener("change",function(){var i=t._settingsFrameRateInput.options[t._settingsFrameRateInput.selectedIndex],n;i&&(n=parseInt(i.value),isNaN(n)||(t._amveUX.frameRate=n))})}return Object.defineProperty(n.prototype,"clientWidth",{get:function(){return this._settingsContainer.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clientHeight",{get:function(){return this._settingsContainer.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._settingsContainer.style},enumerable:!0,configurable:!0}),n}()})(amp||(amp={}));